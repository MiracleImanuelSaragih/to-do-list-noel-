<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Premium To-Do List - Miracle</title>
<meta name="description" content="Premium To-Do List dengan alarm, notifikasi, dan fitur lengkap">
<meta name="author" content="Miracle Imanuel Saragih">
<style>
:root {
  --primary: #667eea;
  --secondary: #764ba2;
  --success: #4caf50;
  --warning: #ff9800;
  --danger: #f44336;
  --dark: #1a1a2e;
  --light: #f8f9fa;
  --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.dark-mode {
  --primary: #8b9eff;
  --secondary: #9d6dd4;
  --bg-gradient: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  --light: #2d2d44;
  --text: #ffffff;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Inter', 'Segoe UI', sans-serif;
  background: var(--bg-gradient);
  min-height: 100vh;
  padding: 20px;
  transition: all 0.3s;
}

.container { max-width: 1200px; margin: auto; }

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: white;
  margin-bottom: 30px;
  flex-wrap: wrap;
  gap: 15px;
}

.header h1 { font-size: 2.2em; }

.header-actions {
  display: flex;
  gap: 10px;
  align-items: center;
}

.icon-btn {
  background: rgba(255,255,255,0.2);
  border: none;
  color: white;
  width: 45px;
  height: 45px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 1.3em;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.icon-btn:hover {
  background: rgba(255,255,255,0.3);
  transform: scale(1.1);
}

.main-card {
  background: white;
  border-radius: 20px;
  padding: 30px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  margin-bottom: 20px;
}

.dark-mode .main-card {
  background: var(--light);
  color: var(--text);
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 15px;
  margin-bottom: 25px;
}

.stat-card {
  background: var(--bg-gradient);
  padding: 20px;
  border-radius: 15px;
  color: white;
  text-align: center;
  transition: transform 0.3s;
}

.stat-card:hover { transform: translateY(-5px); }

.stat-number { font-size: 2em; font-weight: bold; }
.stat-label { font-size: 0.9em; opacity: 0.9; margin-top: 5px; }

.tabs {
  display: flex;
  gap: 10px;
  border-bottom: 2px solid #eee;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.tab {
  background: none;
  border: none;
  padding: 12px 20px;
  cursor: pointer;
  font-size: 1em;
  color: #666;
  border-bottom: 3px solid transparent;
  transition: all 0.3s;
}

.dark-mode .tab { color: #aaa; }

.tab:hover { color: var(--primary); }
.tab.active {
  color: var(--primary);
  border-bottom-color: var(--primary);
  font-weight: 600;
}

.tab-content { display: none; }
.tab-content.active { display: block; animation: fadeIn 0.4s; }

.input-group {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 10px;
  margin-bottom: 20px;
}

.input-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 10px;
}

input, select, textarea {
  padding: 12px 15px;
  border: 2px solid #e0e0e0;
  border-radius: 10px;
  font-size: 1em;
  transition: all 0.3s;
  background: white;
}

.dark-mode input, .dark-mode select, .dark-mode textarea {
  background: #3d3d5c;
  color: white;
  border-color: #555;
}

input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.btn {
  background: var(--bg-gradient);
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 1em;
  font-weight: 600;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  gap: 8px;
  justify-content: center;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.task-item {
  background: #f8f9fa;
  padding: 18px;
  border-radius: 12px;
  margin-bottom: 12px;
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: 15px;
  align-items: start;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
}

.dark-mode .task-item { background: #2d2d44; }

.task-item:hover {
  background: #e8eaf6;
  transform: translateX(5px);
}

.dark-mode .task-item:hover { background: #3d3d5c; }

.task-item.completed {
  opacity: 0.6;
}

.task-item.completed .task-title {
  text-decoration: line-through;
}

.task-item.overdue::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 4px;
  background: var(--danger);
}

.task-item.upcoming::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 4px;
  background: var(--warning);
}

.checkbox {
  width: 24px;
  height: 24px;
  cursor: pointer;
  accent-color: var(--primary);
  margin-top: 3px;
}

.task-content { flex: 1; }

.task-title {
  font-weight: 600;
  font-size: 1.1em;
  margin-bottom: 8px;
  color: #333;
}

.dark-mode .task-title { color: #fff; }

.task-meta {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  font-size: 0.9em;
  color: #666;
  align-items: center;
}

.dark-mode .task-meta { color: #aaa; }

.badge {
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.85em;
  font-weight: 600;
  display: inline-flex;
  align-items: center;
  gap: 5px;
}

.priority-high { background: #ffebee; color: #c62828; }
.priority-medium { background: #fff3e0; color: #ef6c00; }
.priority-low { background: #e8f5e9; color: #2e7d32; }

.category-badge { background: #e3f2fd; color: #1976d2; }

.task-actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.btn-small {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1.2em;
  padding: 8px;
  border-radius: 8px;
  transition: all 0.2s;
}

.btn-small:hover { background: rgba(0,0,0,0.1); }

.filter-group {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.filter-btn {
  padding: 8px 16px;
  background: #f0f0f0;
  border: 2px solid transparent;
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 0.9em;
}

.dark-mode .filter-btn { background: #3d3d5c; color: #fff; }

.filter-btn:hover { background: #e0e0e0; }
.dark-mode .filter-btn:hover { background: #4d4d6c; }

.filter-btn.active {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

.countdown {
  background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
  color: white;
  padding: 15px;
  border-radius: 10px;
  margin-bottom: 20px;
  text-align: center;
  font-size: 1.1em;
  font-weight: 600;
  animation: pulse 2s infinite;
}

.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.7);
  z-index: 1000;
  align-items: center;
  justify-content: center;
}

.modal.show { display: flex; }

.modal-content {
  background: white;
  padding: 30px;
  border-radius: 20px;
  max-width: 500px;
  width: 90%;
  max-height: 80vh;
  overflow-y: auto;
}

.dark-mode .modal-content {
  background: var(--light);
  color: var(--text);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.modal-header h2 { margin: 0; }

.close-modal {
  background: none;
  border: none;
  font-size: 1.5em;
  cursor: pointer;
  color: #666;
}

.form-group {
  margin-bottom: 15px;
}

.form-group label {
  display: block;
  margin-bottom: 5px;
  font-weight: 600;
  color: #333;
}

.dark-mode .form-group label { color: #fff; }

.notification-permission {
  background: #fff3cd;
  border: 2px solid #ffc107;
  padding: 15px;
  border-radius: 10px;
  margin-bottom: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.empty-state {
  text-align: center;
  padding: 60px 20px;
  color: #999;
}

.empty-icon { font-size: 5em; margin-bottom: 15px; }

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

@media (max-width: 768px) {
  .header h1 { font-size: 1.8em; }
  .input-row { grid-template-columns: 1fr; }
  .task-item { grid-template-columns: auto 1fr; }
  .task-actions { grid-column: 1 / -1; justify-content: flex-end; }
}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div>
      <h1>ğŸš€ Premium To-Do List</h1>
      <div id="datetime" style="opacity:0.9; margin-top:5px"></div>
    </div>
    <div class="header-actions">
      <button class="icon-btn" onclick="toggleDarkMode()" title="Dark Mode">ğŸŒ™</button>
      <button class="icon-btn" onclick="requestNotificationPermission()" title="Enable Notifications">ğŸ””</button>
      <button class="icon-btn" onclick="exportData()" title="Export Data">ğŸ’¾</button>
      <button class="icon-btn" onclick="showStats()" title="Statistics">ğŸ“Š</button>
    </div>
  </div>

  <div id="notificationBanner" class="notification-permission" style="display:none">
    <span>ğŸ”” Aktifkan notifikasi untuk alarm & reminder</span>
    <button class="btn" onclick="requestNotificationPermission()">Aktifkan</button>
  </div>

  <div id="countdown"></div>

  <div class="main-card">
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-number" id="totalTasks">0</div>
        <div class="stat-label">Total Tugas</div>
      </div>
      <div class="stat-card" style="background: linear-gradient(135deg, #11998e, #38ef7d)">
        <div class="stat-number" id="completedTasks">0</div>
        <div class="stat-label">Selesai</div>
      </div>
      <div class="stat-card" style="background: linear-gradient(135deg, #ee0979, #ff6a00)">
        <div class="stat-number" id="pendingTasks">0</div>
        <div class="stat-label">Pending</div>
      </div>
      <div class="stat-card" style="background: linear-gradient(135deg, #f093fb, #f5576c)">
        <div class="stat-number" id="todayTasks">0</div>
        <div class="stat-label">Hari Ini</div>
      </div>
    </div>

    <div class="tabs">
      <button class="tab active" onclick="switchTab(event,'todo')">âœ… To-Do</button>
      <button class="tab" onclick="switchTab(event,'schedule')">ğŸ“‹ Jadwal</button>
      <button class="tab" onclick="switchTab(event,'recurring')">ğŸ”„ Berulang</button>
    </div>

    <div id="todo-tab" class="tab-content active">
      <div class="input-group">
        <div class="input-row">
          <input id="todoInput" placeholder="Tambah tugas baru...">
          <select id="todoCategory">
            <option value="general">ğŸ“Œ Umum</option>
            <option value="kuliah">ğŸ“š Kuliah</option>
            <option value="tugas">âœï¸ Tugas</option>
            <option value="pribadi">ğŸ‘¤ Pribadi</option>
            <option value="pekerjaan">ğŸ’¼ Pekerjaan</option>
          </select>
          <select id="todoPriority">
            <option value="low">ğŸŸ¢ Rendah</option>
            <option value="medium" selected>ğŸŸ¡ Sedang</option>
            <option value="high">ğŸ”´ Tinggi</option>
          </select>
        </div>
        <button class="btn" onclick="addTodo()">+ Tambah</button>
      </div>

      <div class="filter-group">
        <button class="filter-btn active" onclick="filterTasks('all')">Semua</button>
        <button class="filter-btn" onclick="filterTasks('pending')">Pending</button>
        <button class="filter-btn" onclick="filterTasks('completed')">Selesai</button>
        <button class="filter-btn" onclick="filterTasks('high')">Prioritas Tinggi</button>
        <button class="filter-btn" onclick="filterTasks('kuliah')">Kuliah</button>
        <button class="filter-btn" onclick="filterTasks('tugas')">Tugas</button>
      </div>

      <div id="todoList"></div>
    </div>

    <div id="schedule-tab" class="tab-content">
      <div class="input-group">
        <div class="input-row">
          <input type="date" id="scheduleDate">
          <input type="time" id="scheduleTime">
          <input id="scheduleInput" placeholder="Kegiatan...">
          <select id="reminderTime">
            <option value="0">Tanpa Reminder</option>
            <option value="5">5 menit sebelum</option>
            <option value="15" selected>15 menit sebelum</option>
            <option value="30">30 menit sebelum</option>
            <option value="60">1 jam sebelum</option>
          </select>
        </div>
        <button class="btn" onclick="addSchedule()">+ Tambah</button>
      </div>

      <div id="scheduleList"></div>
    </div>

    <div id="recurring-tab" class="tab-content">
      <div class="input-group">
        <div class="input-row">
          <input id="recurringInput" placeholder="Tugas berulang...">
          <select id="recurringFreq">
            <option value="daily">Setiap Hari</option>
            <option value="weekly">Setiap Minggu</option>
            <option value="monthly">Setiap Bulan</option>
          </select>
          <input type="time" id="recurringTime">
        </div>
        <button class="btn" onclick="addRecurring()">+ Tambah</button>
      </div>

      <div id="recurringList"></div>
    </div>
  </div>
</div>

<div id="editModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>âœï¸ Edit Tugas</h2>
      <button class="close-modal" onclick="closeModal()">âœ•</button>
    </div>
    <div class="form-group">
      <label>Judul Tugas</label>
      <input id="editText" type="text">
    </div>
    <div class="form-group">
      <label>Kategori</label>
      <select id="editCategory">
        <option value="general">ğŸ“Œ Umum</option>
        <option value="kuliah">ğŸ“š Kuliah</option>
        <option value="tugas">âœï¸ Tugas</option>
        <option value="pribadi">ğŸ‘¤ Pribadi</option>
        <option value="pekerjaan">ğŸ’¼ Pekerjaan</option>
      </select>
    </div>
    <div class="form-group">
      <label>Prioritas</label>
      <select id="editPriority">
        <option value="low">ğŸŸ¢ Rendah</option>
        <option value="medium">ğŸŸ¡ Sedang</option>
        <option value="high">ğŸ”´ Tinggi</option>
      </select>
    </div>
    <button class="btn" onclick="saveEdit()" style="width:100%; margin-top:10px">ğŸ’¾ Simpan</button>
  </div>
</div>

<script>
let todos = JSON.parse(localStorage.getItem('todos_premium')) || [];
let schedules = JSON.parse(localStorage.getItem('schedules_premium')) || [];
let recurring = JSON.parse(localStorage.getItem('recurring_premium')) || [];
let currentFilter = 'all';
let editingId = null;
let editingType = null;
let checkInterval;

const categoryIcons = {
  general: 'ğŸ“Œ', kuliah: 'ğŸ“š', tugas: 'âœï¸', pribadi: 'ğŸ‘¤', pekerjaan: 'ğŸ’¼'
};

function updateDateTime() {
  const now = new Date();
  document.getElementById('datetime').textContent = 
    now.toLocaleString('id-ID', { 
      weekday: 'long', year: 'numeric', month: 'long', 
      day: 'numeric', hour: '2-digit', minute: '2-digit' 
    });
}
updateDateTime();
setInterval(updateDateTime, 1000);

if(Notification.permission === 'default') {
  document.getElementById('notificationBanner').style.display = 'flex';
}

function requestNotificationPermission() {
  if('Notification' in window) {
    Notification.requestPermission().then(permission => {
      if(permission === 'granted') {
        new Notification('âœ… Notifikasi Aktif!', {
          body: 'Anda akan menerima alarm untuk jadwal Anda',
          icon: 'ğŸ””'
        });
        document.getElementById('notificationBanner').style.display = 'none';
      }
    });
  } else {
    alert('Browser Anda tidak support notifikasi');
  }
}

function switchTab(e, tab) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  e.target.classList.add('active');
  document.getElementById(tab + '-tab').classList.add('active');
}

function addTodo() {
  const text = document.getElementById('todoInput').value.trim();
  const category = document.getElementById('todoCategory').value;
  const priority = document.getElementById('todoPriority').value;
  
  if(!text) return alert('Masukkan tugas!');
  
  todos.push({
    id: Date.now(),
    text, category, priority,
    completed: false,
    createdAt: new Date().toISOString()
  });
  
  document.getElementById('todoInput').value = '';
  save();
  render();
  playSound();
}

function addSchedule() {
  const date = document.getElementById('scheduleDate').value;
  const time = document.getElementById('scheduleTime').value;
  const text = document.getElementById('scheduleInput').value.trim();
  const reminder = parseInt(document.getElementById('reminderTime').value);
  
  if(!date || !time || !text) return alert('Lengkapi semua field!');
  
  const datetime = new Date(`${date}T${time}`);
  
  schedules.push({
    id: Date.now(),
    datetime: datetime.toISOString(),
    text, reminder,
    completed: false,
    notified: false
  });
  
  document.getElementById('scheduleDate').value = '';
  document.getElementById('scheduleTime').value = '';
  document.getElementById('scheduleInput').value = '';
  
  save();
  render();
  playSound();
  startAlarmCheck();
}

function addRecurring() {
  const text = document.getElementById('recurringInput').value.trim();
  const freq = document.getElementById('recurringFreq').value;
  const time = document.getElementById('recurringTime').value;
  
  if(!text || !time) return alert('Lengkapi semua field!');
  
  recurring.push({
    id: Date.now(),
    text, freq, time,
    lastCompleted: null
  });
  
  document.getElementById('recurringInput').value = '';
  document.getElementById('recurringTime').value = '';
  
  save();
  render();
  playSound();
}

function toggleTodo(id) {
  const todo = todos.find(t => t.id === id);
  if(todo) {
    todo.completed = !todo.completed;
    save();
    render();
  }
}

function toggleSchedule(id) {
  const schedule = schedules.find(s => s.id === id);
  if(schedule) {
    schedule.completed = !schedule.completed;
    save();
    render();
  }
}

function deleteTodo(id) {
  if(confirm('Hapus tugas ini?')) {
    todos = todos.filter(t => t.id !== id);
    save();
    render();
  }
}

function deleteSchedule(id) {
  if(confirm('Hapus jadwal ini?')) {
    schedules = schedules.filter(s => s.id !== id);
    save();
    render();
  }
}

function deleteRecurring(id) {
  if(confirm('Hapus tugas berulang ini?')) {
    recurring = recurring.filter(r => r.id !== id);
    save();
    render();
  }
}

function editTodo(id) {
  const todo = todos.find(t => t.id === id);
  if(!todo) return;
  
  editingId = id;
  editingType = 'todo';
  document.getElementById('editText').value = todo.text;
  document.getElementById('editCategory').value = todo.category;
  document.getElementById('editPriority').value = todo.priority;
  document.getElementById('editModal').classList.add('show');
}

function saveEdit() {
  if(editingType === 'todo') {
    const todo = todos.find(t => t.id === editingId);
    if(todo) {
      todo.text = document.getElementById('editText').value;
      todo.category = document.getElementById('editCategory').value;
      todo.priority = document.getElementById('editPriority').value;
    }
  }
  
  save();
  render();
  closeModal();
}

function closeModal() {
  document.getElementById('editModal').classList.remove('show');
  editingId = null;
  editingType = null;
}

function filterTasks(filter) {
  currentFilter = filter;
  document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  render();
}

function render() {
  renderTodos();
  renderSchedules();
  renderRecurring();
  updateStats();
  updateCountdown();
}

function renderTodos() {
  const list = document.getElementById('todoList');
  let filtered = todos;
  
  if(currentFilter === 'pending') filtered = todos.filter(t => !t.completed);
  else if(currentFilter === 'completed') filtered = todos.filter(t => t.completed);
  else if(currentFilter === 'high') filtered = todos.filter(t => t.priority === 'high');
  else if(['kuliah','tugas','pribadi','pekerjaan','general'].includes(currentFilter)) {
    filtered = todos.filter(t => t.category === currentFilter);
  }
  
  if(filtered.length === 0) {
    list.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“</div><p>Belum ada tugas</p></div>';
    return;
  }
  
  list.innerHTML = filtered.map(todo => `
    <div class="task-item ${todo.completed ? 'completed' : ''}">
      <input type="checkbox" class="checkbox" ${todo.completed ? 'checked' : ''} 
             onchange="toggleTodo(${todo.id})">
      <div class="task-content">
        <div class="task-title">${todo.text}</div>
        <div class="task-meta">
          <span class="badge priority-${todo.priority}">
            ${todo.priority === 'high' ? 'ğŸ”´ Tinggi' : 
              todo.priority === 'medium' ? 'ğŸŸ¡ Sedang' : 'ğŸŸ¢ Rendah'}
          </span>
          <span class="badge category-badge">${categoryIcons[todo.category]} ${todo.category}</span>
          <span>ğŸ“… ${new Date(todo.createdAt).toLocaleDateString('id-ID')}</span>
        </div>
      </div>
      <div class="task-actions">
        <button class="btn-small" onclick="editTodo(${todo.id})" title="Edit">âœï¸</button>
        <button class="btn-small" onclick="deleteTodo(${todo.id})" title="Hapus">ğŸ—‘ï¸</button>
      </div>
    </div>
  `).join('');
}

function renderSchedules() {
  const list = document.getElementById('scheduleList');
  const sorted = [...schedules].sort((a,b) => 
    new Date(a.datetime) - new Date(b.datetime)
  );
  
  if(sorted.length === 0) {
    list.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ•</div><p>Belum ada jadwal</p></div>';
    return;
  }
  
  const now = new Date();
  
  list.innerHTML = sorted.map(s => {
    const dt = new Date(s.datetime);
    const isPast = dt < now;
    const isUpcoming = !isPast && (dt - now) < 3600000; // 1 jam
    
    return `
      <div class="task-item ${s.completed ? 'completed' : ''} ${isPast && !s.completed ? 'overdue' : ''} ${isUpcoming ? 'upcoming' : ''}">
        <input type="checkbox" class="checkbox" ${s.completed ? 'checked' : ''} 
               onchange="toggleSchedule(${s.id})">
        <div class="task-content">
          <div class="task-title">${s.
